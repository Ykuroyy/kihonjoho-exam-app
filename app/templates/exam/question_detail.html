{% extends "base.html" %}

{% block title %}問題 {{ question.number }} - 基本情報技術者試験{% endblock %}

{% block content %}
<div class="question-detail">
    <div class="question-header">
        <h1>{{ question.year }} {{ question.period }} 問題 {{ question.number }}</h1>
        <span class="category-tag">{{ question.category }}</span>
    </div>

    <div class="question-content">
        <div class="question-text">
            <h3>問題</h3>
            <p>{{ question.question_text }}</p>
        </div>

        <form id="answer-form" method="post" action="{{ url_for('exam.submit_answer', question_id=question.id) }}">
            <div class="choices">
                <h3>選択肢</h3>
                {% for choice in question.choices %}
                <label class="choice-label">
                    <input type="radio" name="choice_symbol" value="{{ choice.symbol }}" required>
                    <span class="choice-symbol">{{ choice.symbol }}</span>
                    <span class="choice-text">{{ choice.text }}</span>
                </label>
                {% endfor %}
            </div>

            <div class="question-actions">
                <button type="submit" class="btn btn-primary">解答する</button>
                <a href="{{ url_for('exam.question_list') }}" class="btn">問題一覧に戻る</a>
            </div>
        </form>
    </div>

    {% if show_result %}
    <div class="result-section">
        <h3>解答結果</h3>
        <div class="result-box {% if is_correct %}correct{% else %}incorrect{% endif %}">
            {% if is_correct %}
                <p class="result-message">✅ 正解です！</p>
            {% else %}
                <p class="result-message">❌ 不正解です</p>
                <p>正解は「<strong>{{ correct_choice.symbol }}</strong>」{{ correct_choice.text }}です。</p>
            {% endif %}
        </div>

        <div class="explanation">
            <h3>解説</h3>
            <p>{{ question.explanation }}</p>
        </div>

        <div class="next-actions">
            {% if next_question %}
                <a href="{{ url_for('exam.question_detail', question_id=next_question.id) }}" class="btn btn-primary">次の問題へ</a>
            {% else %}
                <a href="{{ url_for('exam.my_results') }}" class="btn btn-primary">成績を確認</a>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>

<style>
.question-detail {
    max-width: 800px;
    margin: 0 auto;
}

.question-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.question-content {
    background-color: white;
    padding: 2rem;
    border-radius: 8px;
    margin-bottom: 2rem;
}

.question-text {
    margin-bottom: 2rem;
}

.question-text p {
    font-size: 1.1rem;
    line-height: 1.8;
}

.choices {
    margin-bottom: 2rem;
}

.choice-label {
    display: block;
    padding: 1rem;
    margin-bottom: 0.5rem;
    background-color: #f8f9fa;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.2s;
}

.choice-label:hover {
    background-color: #e9ecef;
}

.choice-label input[type="radio"] {
    margin-right: 0.5rem;
}

.choice-symbol {
    font-weight: bold;
    margin-right: 0.5rem;
}

.question-actions {
    display: flex;
    gap: 1rem;
}

.result-section {
    background-color: white;
    padding: 2rem;
    border-radius: 8px;
}

.result-box {
    padding: 1.5rem;
    border-radius: 4px;
    margin-bottom: 2rem;
}

.result-box.correct {
    background-color: #d4edda;
    border: 1px solid #c3e6cb;
}

.result-box.incorrect {
    background-color: #f8d7da;
    border: 1px solid #f5c6cb;
}

.result-message {
    font-size: 1.2rem;
    font-weight: bold;
    margin: 0;
}

.explanation {
    background-color: #f8f9fa;
    padding: 1.5rem;
    border-radius: 4px;
    margin-bottom: 2rem;
}

.next-actions {
    text-align: center;
}
</style>
{% endblock %}